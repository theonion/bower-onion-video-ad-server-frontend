"use strict";angular.module("video-ads",["ngCookies","ngRoute","ngAnimate","ui.bootstrap","autocomplete","restangular","highcharts-ng"]).constant("STATIC_URL","/static/").config(function($locationProvider,$httpProvider,$routeProvider,$sceDelegateProvider){$sceDelegateProvider.resourceUrlWhitelist(["self","http://assets.onionstatic.com/videoads/*"]),$locationProvider.html5Mode(!0),$routeProvider.when("/",{templateUrl:"views/partials/list.html",controller:"ListCtrl",reloadOnSearch:!1}).when("/login",{templateUrl:"views/partials/login.html",controller:"LoginCtrl"}).when("/edit/:videoAdId/",{templateUrl:"views/partials/form.html",controller:"FormCtrl"}).when("/new/",{templateUrl:"views/partials/form.html",controller:"FormCtrl"}).when("/exclusion/:exclusionName/",{templateUrl:"views/partials/exclusion.html",controller:"ExclusionCtrl"}).otherwise({redirectTo:"/"})}),angular.module("autocomplete",[]).directive("autocomplete",function($http){return{restrict:"E",templateUrl:STATIC_URL+"partials/autocomplete.html",link:function(scope,elem,attrs){scope.placeholder_text=attrs.placeholderText,scope.$watch("autocomplete_input",function(newVal){newVal&&""!==newVal?$http({method:"GET",url:attrs.resourceUrl+newVal}).success(function(data){scope.autocomplete_list=data}):scope.autocomplete_list=[]}),elem.bind("keyup",function(e){if(40===e.keyCode)if(0===$("li.selected",this).length)$("li",this).first().addClass("selected");else{var curSelect=$("li.selected",this),curSelectNext=curSelect.next("li");0===curSelectNext.length?$("li",this).first().addClass("selected"):curSelectNext.addClass("selected"),curSelect.removeClass("selected")}if(38===e.keyCode)if(0===$("li.selected",this).length)$("li",this).last().addClass("selected");else{var curSelect=$("li.selected",this),curSelectNext=curSelect.prev("li");0===curSelectNext.length?$("li",this).last().addClass("selected"):curSelectNext.addClass("selected"),curSelect.removeClass("selected")}if(13===e.keyCode){var selected=$("li.selected",this);if(0===selected.length)return;var selectedId=selected.data("option_id");$("input",this).val(""),scope.autocomplete_list=[],scope.$apply(function(){scope[attrs.callback](selectedId)})}})}}}),function($,window,document,undefined){function S3Upload(element,options){this.element=element,this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this.init()}var pluginName="s3upload",defaults={bootstrap:!0,videoAttrs:{},callback:function(){}};S3Upload.prototype={lastProgress:0,setProgress:function(progress){return 0===progress||100===progress?void this.progressEl.hide():void((0===this.lastProgress||Math.abs(progress-this.lastProgress)>2)&&(this.progressEl.find(".progress-bar").css("width",Math.floor(progress)+"%"),this.lastProgress=progress,this.progressEl.show()))},setProgressText:function(text){this.progressEl.find(".progress-bar span").html(text)},abortUpload:function(){this.setProgress(0),this.button.off("click",this.abortUpload),this.req.abort(),this.button.removeClass("btn-danger"),this.button.addClass("btn-default"),this.button.html("Choose File"),this.button.on("click",$.proxy(this.chooseFile,this)),this.setProgress(0)},abortEncode:function(){var self=this;this.button.off("click"),jobId=$(this.element).attr("data-job-id"),$.ajax("https://app.zencoder.com/api/v2/jobs/"+jobId+"/cancel.json?api_key="+videoAttrs.zencoderApiKey,{type:"PUT",success:function(){self.button.removeClass("btn-danger"),self.button.addClass("btn-default"),self.button.html("Choose File"),$(self.element).attr("data-status","Failed"),self.fakeInput.val("Encoding failed! Please try again."),self.button.on("click",$.proxy(self.chooseFile,self))}})},upload:function(){var self=this;this.button.off("click",this.chooseFile),this.button.addClass("btn-danger"),this.button.removeClass("btn-default"),this.button.html("Abort"),this.button.on("click",$.proxy(this.abortUpload,this));{var file=this.element.files[0],url="https://"+this.options.videoAttrs.bucket+".s3.amazonaws.com",formData=new FormData,path=videoAttrs.directory+"/"+this.videoId+"/original";"s3://"+this.options.videoAttrs.bucket+"/"+path}formData.append("key",path),formData.append("AWSAccessKeyId",this.options.videoAttrs.AWSAccessKeyId),formData.append("acl",this.options.videoAttrs.acl),formData.append("success_action_status",this.options.videoAttrs.success_action_status),formData.append("policy",this.options.videoAttrs.policy),formData.append("signature",this.options.videoAttrs.signature),formData.append("file",file),self.setProgress(0),self.setProgressText("Uploading..."),this.progressEl.find(".progress-bar").removeClass("progress-bar-success"),jQuery.ajax(url,{processData:!1,contentType:!1,data:formData,type:"POST",xhr:function(){var req=$.ajaxSettings.xhr();return req&&req.upload.addEventListener("progress",function(e){var percent=e.loaded/e.total*100;self.setProgress(percent)},!1),self.req=req,req},success:function(){self.setProgress(100),self.fakeInput.val(file.name),$.post("/videos/"+self.videoId,{filename:file.name}),self.encode()}})},updateEncodeProgress:function(){var self=this;this.progressEl.find(".progress-bar").addClass("progress-bar-success"),jobId=$(this.element).attr("data-job-id"),$.ajax("https://app.zencoder.com/api/v2/jobs/"+jobId+"/progress.json",{type:"GET",data:{api_key:videoAttrs.zencoderApiKey},success:function(data){"waiting"===data.state||"pending"===data.state||"processing"===data.state?data.progress>5?(self.setProgress(data.progress),setTimeout($.proxy(self.updateEncodeProgress,self),500)):setTimeout($.proxy(self.updateEncodeProgress,self),2e3):(self.setProgress(0),"finished"==data.state&&($(self.element).attr("data-status","Completed"),self.button.off("click"),self.button.html("Clear"),self.button.on("click",$.proxy(self.clearFile,self))),("failed"==data.state||"cancelled"==data.state)&&($(self.element).attr("data-status","Failed"),self.fakeInput.val("Encoding failed! Please try again."),self.button.off("click"),self.button.html("Choose File"),self.button.on("click",$.proxy(self.chooseFile,self))))}})},encode:function(){var self=this;this.button.off("click"),this.button.on("click",$.proxy(this.abortEncode,this)),this.progressEl.find(".progress-bar").addClass("progress-bar-success"),this.setProgressText("Encoding..."),this.setProgress(5),$.ajax("/videos/"+self.videoId+"/encode",{type:"POST",data:{name:$(self.element).attr("data-video-name")},success:function(data){$(self.element).attr("data-job-id",data.id),self.updateEncodeProgress()}})},chooseFile:function(){console.log("chooseFile"),this.button.off("click",this.chooseFile),this.element.click()},clearFile:function(){this.button.off("click",this.clearFile),this.button.removeClass("btn-danger"),this.button.addClass("btn-default"),this.button.html("Choose File"),this.fakeInput.val(""),this.button.on("click",$.proxy(this.chooseFile,this))},init:function(){var el=$(this.element),self=this;if("INPUT"!=this.element.tagName||"file"!=this.element.type)return console.log("You must attach this to a file input tag!"),!1;el.on("change",function(e){var file;if(0!==e.target.files.length)return file=e.target.files[0],file.size>1073741824?(alert("Upload file cannot be larger than 300MB."),void self.button.on("click",$.proxy(self.chooseFile,self))):0!==file.type.indexOf("video/")?(alert("You must upload a video file."),void self.button.on("click",$.proxy(self.chooseFile,self))):void($(e.target).attr("data-video-id")===undefined?$.ajax({type:"POST",url:"/videos/new",data:{filename:file.name},success:function(data){$(e.target).attr("data-video-id",data.id),self.videoId=data.id,self.options.callback(data.id),self.upload()},dataType:"json"}):self.upload())});var initial_file=el.attr("data-video-name")||"";this.videoId=el.attr("data-video-id"),this.jobId=el.attr("data-job-id"),this.status=el.attr("data-status"),this.progressEl=$('<div class="progress progress-striped active s3uploadProgress"><div class="progress-bar" style="width: 0%"><span class="pull-left">Uploading...</span></div></div>'),this.progressEl.hide(),this.button=$('<label class="btn btn-default pull-right s3uploadButton">Choose File</label>'),""!==initial_file?("In Progress"===this.status&&(this.button.removeClass("btn-default"),this.button.addClass("btn-danger"),this.button.html("Abort"),this.button.on("click",$.proxy(this.abortEncode,this)),this.setProgress(5),this.setProgressText("Encoding..."),this.updateEncodeProgress()),"Complete"===this.status&&(this.button.removeClass("btn-default"),this.button.addClass("btn-danger"),this.button.html("Clear"),this.button.on("click",$.proxy(this.clearFile,this)))):this.button.on("click",$.proxy(this.chooseFile,this)),this.fakeInput=$('<input type="text" class="form-control" value="'+initial_file+'" disabled>'),el.after(this.progressEl),el.after(this.button),el.after(this.fakeInput),el.css("position","absolute"),el.css("left","-6000px")}},$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new S3Upload(this,options))})}}(jQuery,window,document);var videoAttrs={directory:"videoads",AWSAccessKeyId:"AKIAJ242ND767HPT2HJQ",signature:"wHN+x9KT6Y+LexLBKTkmQ9EvOhU=",policy:"eyJjb25kaXRpb25zIjogW3siYnVja2V0IjogIm9uaW9ud2VidGVjaCJ9LCB7ImFjbCI6ICJwcml2YXRlIn0sIHsic3VjY2Vzc19hY3Rpb25fc3RhdHVzIjogIjIwMSJ9LCBbInN0YXJ0cy13aXRoIiwgIiRrZXkiLCAidmlkZW9hZHMiXSwgWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNzM3NDE4MjRdXSwgImV4cGlyYXRpb24iOiAiMjAxNC0xMC0xNVQyMDowOTo0OC4wMDBaIn0=",bucket:"onionwebtech",success_action_status:"201","Content-Type":"$Content-Type",zencoderApiKey:"7401a69bd1bca22e4bb7bf6ae38d4220",acl:"private"};angular.module("video-ads").controller("ExclusionCtrl",function($scope,$http,$routeParams){$scope.exclusion={},$scope.success=!1,$scope.errors=!1,$scope.page_targets=["dfp_adchannel","dfp_pagetype","dfp_viewport","dfp_channel","dfp_articletype","dfp_site","dfp_articleid"],$scope.user_targets=["city","region","country_code"],$http({method:"GET",url:"/api/v1/exclusions/"+$routeParams.exclusionName+"/"}).success(function(data){$scope.exclusion=data}),$scope.save=function(){var data=$scope.exclusion;$http({method:"PATCH",url:"/api/v1/exclusions/"+$routeParams.exclusionName+"/",data:data}).success(function(){$(".alert-success").fadeIn().delay(1e3).fadeOut()}).error(function(){$(".alert-danger").fadeIn().delay(1e3).fadeOut()})}}),angular.module("video-ads").controller("FormCtrl",function($scope,$routeParams,videoAdService,$location){$scope.success=!1,$scope.errors=!1,$scope.videoad={},$scope.page_targets=["dfp_adchannel","dfp_pagetype","dfp_viewport","dfp_channel","dfp_articletype","dfp_site","dfp_articleid"],$scope.user_targets=["city","region","country_code"],$scope.initVideoAd=function(){$scope.videoad.targeting||($scope.videoad.targeting={}),$scope.videoad.targeting.page||($scope.videoad.targeting.page=[]),$scope.videoad.targeting.user||($scope.videoad.targeting.user=[]),$scope.videoad.video=$scope.videoad.video||{};var pickerOptions={timePicker:!0,timePickerIncrement:30,format:"YYYY-MM-DD hh:mm A"},inputVal="";$scope.videoad.start&&(pickerOptions.startDate=moment.utc($scope.videoad.start).local().format("YYYY-MM-DD hh:mm A"),inputVal+=pickerOptions.startDate),$scope.videoad.end&&(pickerOptions.endDate=moment.utc($scope.videoad.end).local().format("YYYY-MM-DD hh:mm A"),inputVal+=" - "+pickerOptions.endDate),$("#runtime").val(inputVal),$("#runtime").daterangepicker(pickerOptions,function(start,end){$scope.videoad.start=moment(start,"YYYY-MM-DD hh:mm A").utc().format(),$scope.videoad.end=moment(end,"YYYY-MM-DD hh:mm A").utc().format()})},$scope.getAndInitVideoAd=function(){_.isUndefined($routeParams.videoAdId)&&($scope.videoAdId={},$scope.initVideoAd()),videoAdService.one($routeParams.videoAdId).get().then(function(data){$scope.videoad=data,$scope.initVideoAd()},function(data){console.log(data)})},$scope.addTargetingKey=function(key){$scope.targetingKey=key},$scope.saveVideoAd=function(){_.isUndefined($routeParams.videoAdId)?($(".alert-danger").fadeIn().delay(1e3).fadeOut(),videoAdService.post($scope.videoad).then(function(data){$location.path("/edit/"+data.id)})):($(".alert-success").fadeIn().delay(1e3).fadeOut(),$scope.videoad.save())},$scope.getAndInitVideoAd()}),angular.module("video-ads").controller("ListCtrl",function($scope,$location,videoAdService,$routeParams){$scope.videoAds=[],$scope.params=_.isEmpty($location.search())?{}:$location.search(),$scope.show_search_bar=!0,$scope.searchTerm="",$scope.currentPage=1,$scope.totalItems=0,$scope.params.filter="active",$scope.params=$routeParams,$scope.loading=!0,$scope.errors=!1,$scope.updateList=function(){void 0===$scope.params.filter&&($scope.params.filter="active"),$location.search($scope.params),videoAdService.getList([$scope.params]).then(function(data){$scope.videoAds=data,$scope.totalItems=data.meta.count,$scope.loading=!1},function(){$scope.loading=!0},function(error){$scope.loading=!1,$scope.errors=!0,console.log(error)})},$scope.updateList(),$scope.newVideoAd=function(){$location.path("/new/")},$scope.changeOrder=function(){$scope.params.orderBy=$scope.orderBy,$scope.reverse&&($scope.params.orderBy="-"+$scope.orderBy),$scope.currentPage=1,$scope.updateList()},$scope.changeFilter=function(){$scope.currentPage=1,$scope.updateList()},$scope.changePage=function(){$scope.params.page=$scope.currentPage,$scope.updateList()},$scope.search=function(){$scope.params.search=$scope.searchTerm,$scope.updateList()}}),angular.module("video-ads").controller("LoginCtrl",function($scope,loginService){$scope.username="",$scope.password="",$scope.submitLogin=function(){loginService.login($scope.username,$scope.password)}}),angular.module("video-ads").directive("delivery",function(){return{templateUrl:STATIC_URL+"partials/delivery-progress.html",scope:{videoad:"="}}}),angular.module("video-ads").directive("pixels",function(){return{templateUrl:STATIC_URL+"partials/pixels.html",scope:{videoad:"=",pixels:"="},link:function($scope){$("#pixels-wrapper").on("keypress","input",function(e){return 13===e.keyCode?($(e.target).parent().find("button").click(),!1):void 0}),$scope.addPixel=function(e){var bt=$(e.target),event=$(bt).parents("[data-event]").data("event"),pixel=$(bt).parent().siblings("input").val();pixel.length>0&&($scope.videoad.pixels[event].push(pixel),$(bt).parent().siblings("input").val(""))},$scope.removePixel=function(event,index){$scope.videoad.pixels[event].splice(index,1)}}}}),angular.module("video-ads").directive("targeting",function(){return{templateUrl:STATIC_URL+"partials/targeting.html",scope:{target:"=",targets:"="},link:function($scope){$scope.priorities=["low","medium","high"],$scope.addTargetingGroup=function(){$scope.target.push({priority:"medium",rules:[["","is",""]]})},$scope.removeTargetingGroup=function(index,confirm){confirm?($scope.target.splice(index,1),$("#confirm-remove-group-modal").modal("hide")):($("#confirm-remove-group-modal-button").off("click"),$("#confirm-remove-group-modal-button").click(function(){$scope.removeTargetingGroup(index,!0),$scope.$apply()}),$("#confirm-remove-group-modal").modal("show"))},$scope.addTargetingRow=function(index){$scope.target[index].rules.push(["","is",""])},$scope.removeTargetingRow=function(parentIndex,index){$scope.target[parentIndex].rules.splice(index,1),0==$scope.target[parentIndex].rules.length&&$scope.target.splice(parentIndex,1)}}}}),angular.module("video-ads").directive("videoUpload",function($http,$window,$timeout){return{templateUrl:STATIC_URL+"partials/videoUpload.html",scope:{videoad:"="},link:function($scope,elem){function upload(){$scope.videoad.video.status=2,$scope.uploading=!0;{var file=$(fileInput)[0].files[0],url="https://"+$window.videoAttrs.bucket+".s3.amazonaws.com",formData=new FormData,path=$window.videoAttrs.directory+"/"+$scope.videoad.video.id+"/original";"s3://"+$window.videoAttrs.bucket+"/"+path}formData.append("key",path),formData.append("AWSAccessKeyId",$window.videoAttrs.AWSAccessKeyId),formData.append("acl",$window.videoAttrs.acl),formData.append("success_action_status",$window.videoAttrs.success_action_status),formData.append("policy",$window.videoAttrs.policy),formData.append("signature",$window.videoAttrs.signature),formData.append("file",file),setProgress(0),setProgressText("Uploading..."),progressBar.removeClass("progress-bar-success"),jQuery.ajax(url,{processData:!1,contentType:!1,data:formData,type:"POST",xhr:function(){var req=$.ajaxSettings.xhr();return req&&req.upload.addEventListener("progress",function(e){var percent=e.loaded/e.total*100;setProgress(percent)},!1),$scope.req=req,req},success:function(){setProgress(100),fakeInput.val(file.name),$http({url:"/videos/"+$scope.videoad.video.id,method:"POST",data:$.param({filename:file.name}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),$http({url:"/videoads/"+$scope.videoad.id+"/save",method:"POST",data:$.param({videoId:$scope.videoad.video.id}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),encode()}})}function encode(){$scope.encoding=!0,progressBar.addClass("progress-bar-success"),setProgressText("Encoding..."),setProgress(5),$http({url:"/videos/"+$scope.videoad.video.id+"/encode",method:"POST",data:{name:$scope.videoad.video.name}}).success(function(data){$scope.videoad.video.job_id=data.id,updateEncodeProgress()}).error(function(){$scope.errors=!0})}function abortUpload(){setProgress(0),$scope.req&&$scope.req.abort(),$scope.videoad.video={},setProgress(0)}function abortEncode(){$.ajax("https://app.zencoder.com/api/v2/jobs/"+$scope.videoad.video.job_id+"/cancel.json?api_key="+$window.videoAttrs.zencoderApiKey,{type:"PUT",success:function(){$scope.videoad.video.status=3,fakeInput.val("Encoding failed! Please try again.")}})}function setProgress(progress){return 0===progress||100===progress?void progressEl.hide():void((0===$scope.lastProgress||Math.abs(progress-$scope.lastProgress)>2)&&(progressBar.css("width",Math.floor(progress)+"%"),$scope.lastProgress=progress,progressEl.show()))}function setProgressText(text){progressText.html(text)}function updateEncodeProgress(){progressBar.addClass("progress-bar-success"),delete $http.defaults.headers.common["X-Requested-With"],$http({url:"https://app.zencoder.com/api/v2/jobs/"+$scope.videoad.video.job_id+"/progress.json",method:"GET",params:{api_key:$window.videoAttrs.zencoderApiKey},useXDomain:!0}).success(function(data){"waiting"===data.state||"pending"===data.state||"processing"===data.state?($scope.videoad.video.status=2,data.progress>5?(setProgress(data.progress),$timeout(updateEncodeProgress,500)):$timeout(updateEncodeProgress,2e3)):(setProgress(0),"finished"==data.state&&($scope.videoad.video.status=1),("failed"==data.state||"cancelled"==data.state)&&($scope.videoad.video.status=3,fakeInput.val("Encoding failed! Please try again.")))}).error(function(){$scope.errors=!0})}$scope.errors=!1,$scope.statuses={0:"Not Started",1:"Complete",2:"In Progress",3:"Failed"};var fileInput=elem.find('input[type="file"]'),progressEl=(elem.find("label.btn"),elem.find("div.progress")),progressBar=elem.find("div.progress-bar"),progressText=elem.find("div.progress span"),fakeInput=elem.find("input.fake-input");$scope.lastProgress=0,fileInput.bind("change",function(e){var file;if(console.log("HELLO"),console.log(e),0!==e.target.files.length){if(file=e.target.files[0],file.size>1073741824)return void alert("Upload file cannot be larger than 300MB.");if(0!==file.type.indexOf("video/"))return void alert("You must upload a video file.");$scope.videoad.video.name=file.name,void 0===$scope.videoad.video.id?(console.log("posting"),$http({method:"POST",url:"/videos/new",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({filename:file.name})}).success(function(data){console.log(data),$scope.videoad.video.id=data.id,upload()})):upload()}}),$scope.chooseFile=function(){console.log("chooseFile"),$(fileInput).click()},$scope.clearFile=function(){$scope.videoad.video={}},$scope.abort=function(){return $scope.encoding?void abortEncode():void abortUpload()};var initialCheckRan=!1;$scope.$watch("videoad.video",function(){$scope.videoad.video&&$scope.videoad.video.job_id&&!initialCheckRan&&(updateEncodeProgress(),initialCheckRan=!0)})}}}),angular.module("video-ads").directive("deliveryChart",function(){return{restrict:"E",templateUrl:STATIC_URL+"partials/chart.html",scope:{impressions:"@impressions"},controller:function($scope){$scope.semiCircleConfig={options:{chart:{type:"pie",backgroundColor:"transparent",height:75,margin:0,width:75},credits:{enabled:!1},tooltip:{enabled:!1},colors:["#008d52","#e2e2e2"]},series:[{dataLabels:{enabled:!1},states:{hover:{enabled:!1}},animation:!1,startAngle:-90,endAngle:90,center:["50%","75%"],innerSize:"50%",name:"Delivery",data:[parseInt($scope.impressions),100-parseInt($scope.impressions)]}],title:{text:""},subtitle:{text:""},loading:!1}}}}),angular.module("video-ads").factory("videoAdService",function(Restangular){return Restangular.setBaseUrl("/api/v1/"),Restangular.setRequestSuffix("/"),Restangular.service("videoads")}).config(function(RestangularProvider){RestangularProvider.addResponseInterceptor(function(data,operation){if("getList"===operation){var results=data.results;return results.meta={count:data.count,prev:data.prev,next:data.next},results}return data})}),angular.module("video-ads").factory("authInterceptor",function($rootScope,$q,$window,$location,httpRequestBuffer){return{request:function(config){return config.headers=config.headers||{},$window.sessionStorage.token&&(config.headers.Authorization="JWT "+$window.sessionStorage.token),config},responseError:function(response){if(!response.config.ignoreAuthModule&&403==response.status){var deferred=$q.defer();httpRequestBuffer.append(response.config,deferred),$rootScope.$broadcast("auth-forbidden",response)}return $q.reject(response)}}}).config(function($httpProvider){$httpProvider.interceptors.push("authInterceptor")}).service("authService",function($window,$http,$rootScope,$location,httpRequestBuffer){return _login=function(){return $http.post("/api-token-auth").then(function(response){$window.sessionStorage.token=response.data.token})},_refreshToken=function(){return $http.post("/api-token-refresh",{token:$window.sessionStorage.token},{ignoreAuthModule:!0}).success(function(response){$window.sessionStorage.token=response.token,httpRequestBuffer.retryAll()}).error(function(){httpRequestBuffer.rejectAll(),$location.path("/login")})},$rootScope.$watch("auth-forbidden",function(){_refreshToken()}),{login:_login,refreshToken:_refreshToken}}).factory("httpRequestBuffer",["$injector",function($injector){function _retryHttpRequest(config,deferred){function successCallback(response){deferred.resolve(response)}function errorCallback(response){deferred.reject(response)}$http=$http||$injector.get("$http"),$http(config).then(successCallback,errorCallback)}var $http,buffer=[];return{append:function(config,deferred){buffer.push({config:config,deferred:deferred})},rejectAll:function(reason){reason&&_.each(buffer,function(request){request.deferred.reject(reason)}),buffer=[]},retryAll:function(){_.each(buffer,function(request){_retryHttpRequest(request.config,request.deferred)})}}}]),angular.module("video-ads").filter("convertToLocal",function(){return function(input){return input?moment.utc(input).local().format("YYYY-MM-DD hh:mm A"):input}});
//# sourceMappingURL=app.min.js.map