{"version":3,"file":"app.min.js","sources":["../../app/scripts/app.js","../../app/scripts/autocomplete.js","../../app/scripts/jquery-video-upload.js","../../app/videos/videoAttrs.js","../../app/scripts/controllers/exclusion.js","../../app/scripts/controllers/video-ad-form.js","../../app/scripts/controllers/list.js","../../app/scripts/controllers/login.js","../../app/scripts/directives/delivery.js","../../app/scripts/directives/pixels.js","../../app/scripts/directives/targeting.js","../../app/scripts/directives/videoupload.js","../../app/scripts/directives/chart.js","../../app/scripts/services/video-ad.js","../../app/scripts/services/token-auth.js","../../app/scripts/filters/converttolocal.js"],"names":["angular","module","constant","config","$locationProvider","$httpProvider","$routeProvider","$sceDelegateProvider","resourceUrlWhitelist","html5Mode","when","templateUrl","controller","reloadOnSearch","otherwise","redirectTo","directive","$http","restrict","STATIC_URL","link","scope","elem","attrs","placeholder_text","placeholderText","$watch","newVal","method","url","resourceUrl","success","data","autocomplete_list","bind","e","keyCode","$","this","length","first","addClass","curSelect","curSelectNext","next","removeClass","last","prev","selected","selectedId","val","$apply","callback","window","document","undefined","S3Upload","element","options","extend","defaults","_defaults","_name","pluginName","init","bootstrap","videoAttrs","prototype","lastProgress","setProgress","progress","progressEl","hide","Math","abs","find","css","floor","show","setProgressText","text","html","abortUpload","button","off","req","abort","on","proxy","chooseFile","abortEncode","self","jobId","attr","ajax","zencoderApiKey","type","fakeInput","upload","file","files","bucket","formData","FormData","path","directory","videoId","append","AWSAccessKeyId","acl","success_action_status","policy","signature","jQuery","processData","contentType","xhr","ajaxSettings","addEventListener","percent","loaded","total","name","post","filename","encode","updateEncodeProgress","api_key","state","setTimeout","clearFile","id","console","log","click","el","tagName","target","size","alert","indexOf","dataType","initial_file","status","after","fn","each","Content-Type","$scope","$routeParams","exclusion","errors","page_targets","user_targets","exclusionName","save","fadeIn","delay","fadeOut","error","videoAdService","$location","videoad","initVideoAd","targeting","page","user","video","pickerOptions","timePicker","timePickerIncrement","format","inputVal","start","startDate","moment","utc","local","end","endDate","daterangepicker","getAndInitVideoAd","_","isUndefined","videoAdId","one","get","then","addTargetingKey","key","targetingKey","saveVideoAd","videoAds","params","isEmpty","search","show_search_bar","searchTerm","currentPage","totalItems","filter","loading","updateList","getList","meta","count","newVideoAd","changeOrder","orderBy","reverse","changeFilter","changePage","loginService","username","password","submitLogin","login","pixels","parent","addPixel","bt","event","parents","pixel","siblings","push","removePixel","index","splice","targets","priorities","addTargetingGroup","priority","rules","removeTargetingGroup","confirm","modal","addTargetingRow","removeTargetingRow","parentIndex","$window","$timeout","uploading","fileInput","progressBar","param","headers","encoding","job_id","progressText","common","useXDomain","statuses",1,2,3,"initialCheckRan","impressions","semiCircleConfig","chart","backgroundColor","height","margin","width","credits","enabled","tooltip","colors","series","dataLabels","states","hover","animation","startAngle","endAngle","center","innerSize","parseInt","title","subtitle","factory","Restangular","setBaseUrl","setRequestSuffix","service","RestangularProvider","addResponseInterceptor","operation","results","$rootScope","$q","httpRequestBuffer","request","sessionStorage","token","Authorization","responseError","response","ignoreAuthModule","deferred","defer","$broadcast","reject","interceptors","_login","_refreshToken","retryAll","rejectAll","refreshToken","$injector","_retryHttpRequest","successCallback","resolve","errorCallback","buffer","reason","input"],"mappings":"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","sourcesContent":["'use strict';\n\n// ****** App Config ****** \\\\\n\nangular.module('video-ads', [\n  'ngCookies',\n  'ngRoute',\n  'ngAnimate',\n  'ui.bootstrap',\n  'autocomplete',\n  'restangular',\n  'highcharts-ng'\n])\n  .constant(\"STATIC_URL\", \"/static/\")\n  .config(function($locationProvider, $httpProvider, $routeProvider, $sceDelegateProvider) {\n    $sceDelegateProvider.resourceUrlWhitelist(['self', 'http://assets.onionstatic.com/videoads/*']);\n\n    $locationProvider.html5Mode(true);\n\n    $routeProvider\n      .when('/', {\n        templateUrl: 'views/partials/list.html',\n        controller: 'ListCtrl',\n        reloadOnSearch: false\n      })\n      .when('/login', {\n        templateUrl: 'views/partials/login.html',\n        controller: 'LoginCtrl'\n      })\n      .when('/edit/:videoAdId/', {\n        templateUrl: 'views/partials/form.html',\n        controller: 'FormCtrl'\n      })\n      .when('/new/', {\n        templateUrl: 'views/partials/form.html',\n        controller: 'FormCtrl'\n      })\n      .when('/exclusion/:exclusionName/', {\n        templateUrl: 'views/partials/exclusion.html',\n        controller: 'ExclusionCtrl'\n      })\n      .otherwise({\n        redirectTo: '/'\n      });\n  });","'use strict';\nangular.module('autocomplete', [])\n.directive('autocomplete', function($http, $location){\n\treturn {\n\t\trestrict: 'E',\n\t\ttemplateUrl: STATIC_URL + 'partials/autocomplete.html',\n\t\tlink: function(scope, elem, attrs){\n\t\t\tscope.placeholder_text = attrs.placeholderText;\n\t\t\tscope.$watch('autocomplete_input', function(newVal, oldVal){\n\t\t\t\tif(!newVal || newVal === \"\"){\n\t\t\t\t\tscope.autocomplete_list = [];\n\t\t\t\t}else{\n\t\t\t\t\t$http({\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\turl: attrs.resourceUrl + newVal\n\t\t\t\t\t}).success(function(data){\n\t\t\t\t\t\tscope.autocomplete_list = data;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\telem.bind('keyup', function(e){\n\t\t\t\tif(e.keyCode === 40){\n\t\t\t\t\tif($('li.selected', this).length === 0){\n\t\t\t\t\t\t$('li', this).first().addClass('selected');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar curSelect = $('li.selected', this);\n\t\t\t\t\t\tvar curSelectNext = curSelect.next('li');\n\t\t\t\t\t\tif(curSelectNext.length === 0){\n\t\t\t\t\t\t\t$('li', this).first().addClass('selected');\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcurSelectNext.addClass('selected');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurSelect.removeClass('selected');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(e.keyCode === 38){\n\t\t\t\t\tif($('li.selected', this).length === 0){\n\t\t\t\t\t\t$('li', this).last().addClass('selected');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar curSelect = $('li.selected', this);\n\t\t\t\t\t\tvar curSelectNext = curSelect.prev('li');\n\t\t\t\t\t\tif(curSelectNext.length === 0){\n\t\t\t\t\t\t\t$('li', this).last().addClass('selected');\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcurSelectNext.addClass('selected');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurSelect.removeClass('selected');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(e.keyCode === 13){\n\t\t\t\t\tvar selected = $('li.selected', this);\n\t\t\t\t\tif(selected.length === 0) return;\n\t\t\t\t\tvar selectedId = selected.data('option_id');\n\t\t\t\t\t$('input', this).val('');\n\t\t\t\t\tscope.autocomplete_list = [];\n\t\t\t\t\tscope.$apply(function(){\n\t\t\t\t\t\tscope[attrs.callback](selectedId);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t}\n});","/*!\n * S3 Upload\n * Original author: @chrissinchok\n * Licensed under the MIT license\n */\n\n// the semi-colon before the function invocation is a safety\n// net against concatenated scripts and/or other plugins\n// that are not closed properly.\n;(function ( $, window, document, undefined ) {\n\n    // undefined is used here as the undefined global\n    // variable in ECMAScript 3 and is mutable (i.e. it can\n    // be changed by someone else). undefined isn't really\n    // being passed in so we can ensure that its value is\n    // truly undefined. In ES5, undefined can no longer be\n    // modified.\n\n    // window and document are passed through as local\n    // variables rather than as globals, because this (slightly)\n    // quickens the resolution process and can be more\n    // efficiently minified (especially when both are\n    // regularly referenced in your plugin).\n\n    // Create the defaults once\n    var pluginName = \"s3upload\",\n        defaults = {\n            bootstrap: true,  // This is all I will be building, at least initially.\n            videoAttrs: {},\n            callback: function(){}\n        };\n\n    // The actual plugin constructor\n    function S3Upload( element, options ) {\n        this.element = element;\n\n        // jQuery has an extend method that merges the\n        // contents of two or more objects, storing the\n        // result in the first object. The first object\n        // is generally empty because we don't want to alter\n        // the default options for future instances of the plugin\n        this.options = $.extend( {}, defaults, options) ;\n\n        this._defaults = defaults;\n        this._name = pluginName;\n\n        this.init();\n    }\n\n    S3Upload.prototype = {\n\n        lastProgress: 0,\n\n        setProgress: function(progress) {\n            if (progress === 0 || progress === 100) {\n                this.progressEl.hide();\n                return;\n            }\n            if(this.lastProgress === 0 || Math.abs(progress - this.lastProgress) > 2) {\n                this.progressEl.find('.progress-bar').css('width', Math.floor(progress) + '%');\n                this.lastProgress = progress;\n                this.progressEl.show();\n            }\n        },\n\n        setProgressText: function(text) {\n            this.progressEl.find('.progress-bar span').html(text);\n        },\n\n        abortUpload: function(e) {\n            this.setProgress(0);\n            this.button.off('click', this.abortUpload);\n            this.req.abort();\n            this.button.removeClass('btn-danger');\n            this.button.addClass('btn-default');\n            this.button.html(\"Choose File\");\n            this.button.on('click', $.proxy(this.chooseFile, this));\n            this.setProgress(0);\n        },\n\n        abortEncode: function(e) {\n            var self = this;\n\n            this.button.off('click');\n\n            jobId = $(this.element).attr('data-job-id');\n            $.ajax(\"https://app.zencoder.com/api/v2/jobs/\" + jobId + \"/cancel.json?api_key=\" + videoAttrs.zencoderApiKey, {\n                type: \"PUT\",\n                success: function(data) {\n                    self.button.removeClass('btn-danger');\n                    self.button.addClass('btn-default');\n                    self.button.html(\"Choose File\");\n                    $(self.element).attr('data-status', \"Failed\");\n\n                    self.fakeInput.val(\"Encoding failed! Please try again.\");\n\n                    self.button.on('click', $.proxy(self.chooseFile, self));\n                }\n            });\n        },\n\n        upload: function() {\n\n            // TODO: Add cancel button.\n            var self = this;\n\n            this.button.off('click', this.chooseFile);\n            this.button.addClass('btn-danger');\n            this.button.removeClass('btn-default');\n            this.button.html(\"Abort\");\n            this.button.on('click', $.proxy(this.abortUpload, this));\n\n            var file = this.element.files[0];\n            var url = \"https://\" + this.options.videoAttrs.bucket + \".s3.amazonaws.com\";\n\n            var formData = new FormData();\n            var path = videoAttrs.directory + \"/\" + this.videoId + \"/original\";\n            var filename = \"s3://\" + this.options.videoAttrs.bucket + \"/\" + path;\n\n            formData.append('key', path);\n            formData.append('AWSAccessKeyId', this.options.videoAttrs.AWSAccessKeyId);\n            formData.append('acl', this.options.videoAttrs.acl);\n            formData.append('success_action_status', this.options.videoAttrs.success_action_status);\n            formData.append('policy', this.options.videoAttrs.policy);\n            formData.append('signature', this.options.videoAttrs.signature);\n            formData.append('file', file);\n\n            self.setProgress(0);\n            self.setProgressText(\"Uploading...\");\n            this.progressEl.find('.progress-bar').removeClass('progress-bar-success');\n            // Todo: handle failure\n            jQuery.ajax(url, {\n                processData: false,\n                contentType: false,\n                data: formData,\n                type: \"POST\",\n                xhr: function() {\n                    var req = $.ajaxSettings.xhr();\n                    if (req) {\n                        req.upload.addEventListener('progress', function(e) {\n                            var percent = (e.loaded / e.total ) * 100;\n                            self.setProgress(percent);\n                        }, false);\n                    }\n                    self.req = req;\n                    return req;\n                },\n                success: function(data) {\n                    self.setProgress(100);\n                    self.fakeInput.val(file.name);\n                    $.post('/videos/' + self.videoId, {\n                        'filename': file.name\n                    });\n                    self.encode();\n                }\n            });\n        },\n\n        updateEncodeProgress: function() {\n            var self = this;\n            this.progressEl.find('.progress-bar').addClass('progress-bar-success');\n\n            jobId = $(this.element).attr('data-job-id');\n            $.ajax(\"https://app.zencoder.com/api/v2/jobs/\" + jobId + \"/progress.json\", {\n                type: \"GET\",\n                data: {\n                    api_key: videoAttrs.zencoderApiKey\n                },\n                success: function(data) {\n                    if(data.state === \"waiting\" || data.state === \"pending\" || data.state === \"processing\") {\n                        if(data.progress > 5) {\n                            self.setProgress(data.progress);\n                            setTimeout($.proxy(self.updateEncodeProgress, self), 500);\n                        } else {\n                            setTimeout($.proxy(self.updateEncodeProgress, self), 2000);\n                        }\n                    } else {\n                        self.setProgress(0);\n                        if(data.state == \"finished\") {\n                            $(self.element).attr('data-status', \"Completed\");\n                            self.button.off('click');\n                            self.button.html('Clear');\n                            self.button.on('click', $.proxy(self.clearFile, self));\n                        }\n                        if(data.state == \"failed\" || data.state == \"cancelled\") {\n                            $(self.element).attr('data-status', \"Failed\");\n                            self.fakeInput.val(\"Encoding failed! Please try again.\");\n                            self.button.off('click');\n                            self.button.html('Choose File');\n                            self.button.on('click', $.proxy(self.chooseFile, self));\n                        }\n                    }\n                }\n            });\n        },\n\n        encode: function() {\n            var self = this;\n\n            this.button.off('click');\n            this.button.on('click', $.proxy(this.abortEncode, this));\n\n            this.progressEl.find('.progress-bar').addClass('progress-bar-success');\n            this.setProgressText(\"Encoding...\");\n            this.setProgress(5);\n            // Kick off the zencoder job\n            $.ajax('/videos/' + self.videoId + \"/encode\", {\n                type: \"POST\",\n                data: {\n                    'name': $(self.element).attr('data-video-name'),\n                },\n                success: function(data) {\n                    $(self.element).attr('data-job-id', data.id);\n                    self.updateEncodeProgress();\n                }\n            });\n        },\n\n        chooseFile: function(e) {\n            console.log(\"chooseFile\")\n            this.button.off('click', this.chooseFile);\n            this.element.click();\n        },\n\n        clearFile: function(e) {\n            this.button.off('click', this.clearFile);\n            this.button.removeClass('btn-danger');\n            this.button.addClass('btn-default');\n            this.button.html(\"Choose File\");\n            this.fakeInput.val('');\n            this.button.on('click', $.proxy(this.chooseFile, this));\n        },\n\n        init: function() {\n            var el = $(this.element);\n            var self = this;\n\n            if(this.element.tagName != \"INPUT\" || this.element.type != \"file\") {\n                console.log(\"You must attach this to a file input tag!\");\n                return false;\n            }\n\n            el.on('change', function(e) {\n                var file;\n                if(e.target.files.length !== 0) {\n                    file = e.target.files[0];\n\n                    // We have a file upload limit of 300MB\n                    if (file.size > (1024 * 1024 * 1024)) {\n                        alert(\"Upload file cannot be larger than 300MB.\");\n                        self.button.on('click', $.proxy(self.chooseFile, self));\n                        return;\n                    }\n\n                    if (file.type.indexOf('video/') !== 0) {\n                        alert(\"You must upload a video file.\");\n                        self.button.on('click', $.proxy(self.chooseFile, self));\n                        return;\n                    }\n\n                } else {\n                    return;\n                }\n\n                if($(e.target).attr('data-video-id') === undefined) {\n                    $.ajax({\n                        type: \"POST\",\n                        url: \"/videos/new\",\n                        data: {'filename': file.name},\n                        success: function(data, textStatus, jqXHR){\n                            $(e.target).attr('data-video-id', data.id);\n                            self.videoId = data.id;\n                            self.options.callback(data.id);\n                            self.upload();\n                        },\n                        dataType: \"json\"\n                    });\n                } else {\n                    self.upload();\n                }\n            });\n\n            var initial_file = el.attr('data-video-name') || \"\";\n            this.videoId = el.attr('data-video-id');\n            this.jobId = el.attr('data-job-id');\n            this.status = el.attr('data-status');\n\n            this.progressEl = $('<div class=\"progress progress-striped active s3uploadProgress\"><div class=\"progress-bar\" style=\"width: 0%\"><span class=\"pull-left\">Uploading...</span></div></div>');\n            this.progressEl.hide();\n\n            this.button = $('<label class=\"btn btn-default pull-right s3uploadButton\">Choose File</label>');\n\n            if(initial_file !== \"\") {\n                if(this.status === \"In Progress\") {\n                    this.button.removeClass('btn-default');\n                    this.button.addClass('btn-danger');\n                    this.button.html(\"Abort\");\n                    this.button.on('click', $.proxy(this.abortEncode, this));\n\n                    this.setProgress(5);\n                    this.setProgressText(\"Encoding...\");\n                    this.updateEncodeProgress();\n                }\n                if(this.status === \"Complete\") {\n                    this.button.removeClass('btn-default');\n                    this.button.addClass('btn-danger');\n                    this.button.html(\"Clear\");\n                    this.button.on('click', $.proxy(this.clearFile, this));\n                }\n\n            } else {\n                this.button.on('click', $.proxy(this.chooseFile, this));\n            }\n\n            this.fakeInput = $('<input type=\"text\" class=\"form-control\" value=\"' + initial_file + '\" disabled>');\n\n            el.after(this.progressEl);\n            el.after(this.button);\n            el.after(this.fakeInput);\n            el.css('position', 'absolute');\n            el.css('left', '-6000px');\n        },\n    };\n\n    // A really lightweight plugin wrapper around the constructor,\n    // preventing against multiple instantiations\n    $.fn[pluginName] = function ( options ) {\n        return this.each(function () {\n            if (!$.data(this, \"plugin_\" + pluginName)) {\n                $.data(this, \"plugin_\" + pluginName,\n                new S3Upload( this, options ));\n            }\n        });\n    };\n\n})( jQuery, window, document );","var videoAttrs = {\"directory\": \"videoads\", \"AWSAccessKeyId\": \"AKIAJ242ND767HPT2HJQ\", \"signature\": \"wHN+x9KT6Y+LexLBKTkmQ9EvOhU=\", \"policy\": \"eyJjb25kaXRpb25zIjogW3siYnVja2V0IjogIm9uaW9ud2VidGVjaCJ9LCB7ImFjbCI6ICJwcml2YXRlIn0sIHsic3VjY2Vzc19hY3Rpb25fc3RhdHVzIjogIjIwMSJ9LCBbInN0YXJ0cy13aXRoIiwgIiRrZXkiLCAidmlkZW9hZHMiXSwgWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNzM3NDE4MjRdXSwgImV4cGlyYXRpb24iOiAiMjAxNC0xMC0xNVQyMDowOTo0OC4wMDBaIn0=\", \"bucket\": \"onionwebtech\", \"success_action_status\": \"201\", \"Content-Type\": \"$Content-Type\", \"zencoderApiKey\": \"7401a69bd1bca22e4bb7bf6ae38d4220\", \"acl\": \"private\"};","'use strict';\n\nangular.module('video-ads')\n    .controller('ExclusionCtrl', function ($scope, $http, $routeParams) {\n        $scope.exclusion = {};\n        $scope.success = false;\n        $scope.errors = false;\n\n        $scope.page_targets = [\n            'dfp_adchannel',\n            'dfp_pagetype',\n            'dfp_viewport',\n            'dfp_channel',\n            'dfp_articletype',\n            'dfp_site',\n            'dfp_articleid'\n        ];\n        $scope.user_targets = [\n            'city',\n            'region',\n            'country_code'\n        ];\n\n        $http({\n            method: 'GET',\n            url: '/api/v1/exclusions/' + $routeParams.exclusionName + '/'\n        }).success(function(data){\n            $scope.exclusion = data;\n        });\n\n        $scope.save = function() {\n            var data = $scope.exclusion;\n            $http({\n                method: 'PATCH',\n                url: '/api/v1/exclusions/' + $routeParams.exclusionName + '/',\n                data: data\n            }).success(function(data){\n                $('.alert-success').fadeIn().delay(1000).fadeOut()\n            }).error(function(data){\n                $('.alert-danger').fadeIn().delay(1000).fadeOut()\n            });\n        };\n    });","'use strict';\n\nangular.module('video-ads')\n  .controller('FormCtrl', function ($scope, $routeParams, videoAdService, $location) {\n    $scope.success = false;\n    $scope.errors = false;\n    $scope.videoad = {};\n    //TODO: Magic strings could be moved into constants?\n    $scope.page_targets = [\n      'dfp_adchannel',\n      'dfp_pagetype',\n      'dfp_viewport',\n      'dfp_channel',\n      'dfp_articletype',\n      'dfp_site',\n      'dfp_articleid'\n    ];\n    $scope.user_targets = [\n      'city',\n      'region',\n      'country_code'];\n\n    $scope.initVideoAd = function () {\n      if (!$scope.videoad.targeting) {\n        $scope.videoad.targeting = {};\n      }\n      if (!$scope.videoad.targeting.page) {\n        $scope.videoad.targeting.page = [];\n      }\n      if (!$scope.videoad.targeting.user) {\n        $scope.videoad.targeting.user = [];\n      }\n      $scope.videoad.video = $scope.videoad.video || {};\n      var pickerOptions = {\n        timePicker: true,\n        timePickerIncrement: 30,\n        format: 'YYYY-MM-DD hh:mm A'\n      };\n\n      var inputVal = \"\";\n      if ($scope.videoad.start) {\n        pickerOptions.startDate = moment.utc($scope.videoad.start).local().format('YYYY-MM-DD hh:mm A');\n        inputVal += pickerOptions.startDate;\n      }\n\n      if ($scope.videoad.end) {\n        pickerOptions.endDate = moment.utc($scope.videoad.end).local().format('YYYY-MM-DD hh:mm A');\n        inputVal += \" - \" + pickerOptions.endDate;\n      }\n\n      $('#runtime').val(inputVal);\n\n      $('#runtime').daterangepicker(pickerOptions, function (start, end) {\n        $scope.videoad.start = moment(start, 'YYYY-MM-DD hh:mm A').utc().format();\n        $scope.videoad.end = moment(end, 'YYYY-MM-DD hh:mm A').utc().format();\n      });\n    };\n\n    $scope.getAndInitVideoAd = function () {\n      if (_.isUndefined($routeParams.videoAdId)) {\n        $scope.videoAdId = {};\n        $scope.initVideoAd();\n      }\n      videoAdService.one($routeParams.videoAdId).get().then(\n        function (data) {\n          $scope.videoad = data;\n          $scope.initVideoAd();\n        },\n        function (data) {\n          console.log(data);\n        }\n      );\n    };\n\n    $scope.addTargetingKey = function (key) {\n      $scope.targetingKey = key;\n    };\n\n    $scope.saveVideoAd = function () {\n      if (!_.isUndefined($routeParams.videoAdId)) {\n        $('.alert-success').fadeIn().delay(1000).fadeOut();\n        $scope.videoad.save();\n      } else {\n        $('.alert-danger').fadeIn().delay(1000).fadeOut();\n        videoAdService.post($scope.videoad)\n          .then(function (data) {\n            $location.path('/edit/' + data.id);\n          });\n      }\n    };\n    $scope.getAndInitVideoAd();\n  });","'use strict';\nangular.module('video-ads')\n  .controller('ListCtrl', function($scope, $location, videoAdService, $routeParams) {\n    $scope.videoAds = [];\n    if (_.isEmpty($location.search())) {\n      $scope.params = {};\n    } else {\n      $scope.params = $location.search();\n    }\n    $scope.show_search_bar = true;\n    $scope.searchTerm = \"\";\n    $scope.currentPage = 1;\n    $scope.totalItems = 0;\n    $scope.params.filter = 'active';\n    $scope.params = $routeParams;\n    $scope.loading = true;\n    $scope.errors = false;\n\n    $scope.updateList = function() {\n      if ($scope.params.filter === undefined) {\n        $scope.params.filter = \"active\";\n      }\n      $location.search($scope.params);\n      videoAdService.getList([$scope.params]).then(function(data) {\n        $scope.videoAds = data;\n        $scope.totalItems = data.meta.count;\n        $scope.loading = false;\n      }, function(progress) {\n          $scope.loading = true;\n      }, function(error) {\n          $scope.loading = false;\n          $scope.errors = true;\n          console.log(error);\n      });\n    };\n\n    $scope.updateList();\n\n    $scope.newVideoAd = function() {\n      $location.path('/new/');\n    };\n\n    $scope.changeOrder = function() {\n      $scope.params.orderBy = $scope.orderBy;\n      if ($scope.reverse) {\n        $scope.params.orderBy = \"-\" + $scope.orderBy;\n      }\n      //Setting currentPage to 1 will trigger the currentPage watch to fire\n      $scope.currentPage = 1;\n      $scope.updateList();\n    };\n\n    $scope.changeFilter = function() {\n      //This will trigger the above watch statement, which will trigger an updateList()\n      $scope.currentPage = 1;\n      $scope.updateList();\n    };\n\n    $scope.changePage = function() {\n      $scope.params.page = $scope.currentPage;\n      $scope.updateList();\n    };\n\n    $scope.search = function() {\n      $scope.params.search = $scope.searchTerm;\n      $scope.updateList();\n    };\n\n  });","'use strict';\n\nangular.module('video-ads')\n    .controller('LoginCtrl', function($scope, loginService) {\n        $scope.username = \"\";\n        $scope.password = \"\";\n        $scope.submitLogin = function() {\n            loginService.login($scope.username, $scope.password);\n        }\n    });","'use strict';\n\nangular.module('video-ads')\n  .directive('delivery', function() {\n    return {\n      templateUrl: STATIC_URL + 'partials/delivery-progress.html',\n      scope: {\n          'videoad': '='\n      }\n    }\n  });","'use strict';\n\nangular.module('video-ads')\n\t.directive('pixels', function() {\n\t\treturn {\n\t\t\ttemplateUrl: STATIC_URL + 'partials/pixels.html',\n\t\t\tscope: {\n\t\t\t\t'videoad': '=',\n\t\t\t\t'pixels': '='\n\t\t\t},\n\t\t\tlink: function($scope, elem, attrs){\n\t\t\t\t$(\"#pixels-wrapper\").on('keypress', 'input', function(e){\n\t\t\t\t\tif(e.keyCode === 13){\n\t\t\t\t\t\t$(e.target).parent().find('button').click();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t$scope.addPixel = function(e){\n\t\t\t\t\tvar bt = $(e.target);\n\t\t\t\t\tvar event = $(bt).parents('[data-event]').data('event');\n\t\t\t\t\tvar pixel = $(bt).parent().siblings('input').val()\n\t\t\t\t\tif(pixel.length > 0){\n\t\t\t\t\t\t$scope.videoad.pixels[event].push(pixel)\n\t\t\t\t\t\t$(bt).parent().siblings('input').val('')\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$scope.removePixel = function(event, index){\n\t\t\t\t\t$scope.videoad.pixels[event].splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});","'use strict';\n\nangular.module('video-ads')\n\t.directive('targeting', function() {\n\t\treturn {\n\t\t\ttemplateUrl: STATIC_URL + 'partials/targeting.html',\n\t\t\tscope: {\n\t\t\t\t'target': '=',\n\t\t\t\t'targets': '='\n\t\t\t},\n\t\t\tlink: function($scope, elem, attrs){\n\t\t\t\t$scope.priorities = [\n\t\t\t\t\t'low', \n\t\t\t\t\t'medium', \n\t\t\t\t\t'high'\n\t\t\t\t];\n\n\t\t\t\t$scope.addTargetingGroup = function(){\n\t\t\t\t\t$scope.target.push({\"priority\": \"medium\", \"rules\": [['', 'is', '']]});\n\t\t\t\t};\n\t\t\t\t$scope.removeTargetingGroup = function(index, confirm){\n\t\t\t\t\tif(confirm){\n\t\t\t\t\t\t$scope.target.splice(index, 1);\n\t\t\t\t\t\t$(\"#confirm-remove-group-modal\").modal('hide')\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(\"#confirm-remove-group-modal-button\").off('click');\n\t\t\t\t\t\t$(\"#confirm-remove-group-modal-button\").click(function(){\n\t\t\t\t\t\t\t$scope.removeTargetingGroup(index, true);\n\t\t\t\t\t\t\t$scope.$apply();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$(\"#confirm-remove-group-modal\").modal('show')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$scope.addTargetingRow = function(index){\n\t\t\t\t\t$scope.target[index][\"rules\"].push(['', 'is', '']);\n\t\t\t\t}\n\t\t\t\t$scope.removeTargetingRow = function(parentIndex, index){\n\t\t\t\t\t$scope.target[parentIndex][\"rules\"].splice(index, 1);\n\t\t\t\t\tif($scope.target[parentIndex][\"rules\"].length == 0){\n\t\t\t\t\t\t$scope.target.splice(parentIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});","'use strict';\n\nangular.module('video-ads')\n\t.directive('videoUpload', function ($http, $window, $timeout) {\n\t\treturn {\n\t\t\ttemplateUrl: STATIC_URL + 'partials/videoUpload.html',\n\t\t\tscope: {\n\t\t\t\t'videoad': '='\n\t\t\t},\n\t\t\tlink: function($scope, elem, attrs){\n\t\t\t\t$scope.errors = false;\n\t\t\t\t$scope.statuses = {\n\t\t\t\t\t0: \"Not Started\",\n\t\t\t\t\t1: \"Complete\",\n\t\t\t\t\t2: \"In Progress\",\n\t\t\t\t\t3: \"Failed\"\n\t\t\t\t};\n\n\t\t\t\tvar fileInput = elem.find('input[type=\"file\"]');\n\t\t\t\tvar button = elem.find('label.btn');\n\t\t\t\tvar progressEl = elem.find('div.progress');\n\t\t\t\tvar progressBar = elem.find('div.progress-bar');\n\t\t\t\tvar progressText = elem.find('div.progress span');\n\t\t\t\tvar fakeInput = elem.find('input.fake-input');\n\t\t\t\t$scope.lastProgress = 0;\n\n\t\t\t\tfileInput.bind('change', function(e) {\n\t\t\t\t\tvar file;\n\t\t\t\t\tconsole.log(\"HELLO\")\n\t\t\t\t\tconsole.log(e);\n\n\t\t\t\t\tif(e.target.files.length !== 0) {\n\t\t\t\t\t\tfile = e.target.files[0];\n\n\t\t\t\t\t\t// We have a file upload limit of 300MB\n\t\t\t\t\t\tif (file.size > (1024 * 1024 * 1024)) {\n\t\t\t\t\t\t\talert(\"Upload file cannot be larger than 300MB.\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (file.type.indexOf('video/') !== 0) {\n\t\t\t\t\t\t\talert(\"You must upload a video file.\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.videoad.video.name = file.name;\n\n\t\t\t\t\tif($scope.videoad.video.id === undefined) {\n\t\t\t\t\t\tconsole.log(\"posting\");\n\t\t\t\t\t\t$http({\n\t\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\t\turl: \"/videos/new\",\n\t\t\t\t\t\t\theaders: {'Content-Type': 'application/x-www-form-urlencoded'},\n\t\t\t\t\t\t\tdata: $.param({'filename': file.name})\n\t\t\t\t\t\t}).success(function(data){\n\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t\t$scope.videoad.video.id = data.id;\n\t\t\t\t\t\t\t//TODO\n\t\t\t\t\t\t\t//self.options.callback(data.id);\n\t\t\t\t\t\t\tupload();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tupload();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction upload(){\n\t\t\t\t\t$scope.videoad.video.status = 2;\n\t\t\t\t\t$scope.uploading = true;\n\t\t\t\t\tvar file = $(fileInput)[0].files[0];\n\t\t\t\t\tvar url = \"https://\" + $window.videoAttrs.bucket + \".s3.amazonaws.com\";\n\n\t\t\t\t\tvar formData = new FormData();\n\t\t\t\t\tvar path = $window.videoAttrs.directory + \"/\" + $scope.videoad.video.id + \"/original\";\n\t\t\t\t\tvar filename = \"s3://\" + $window.videoAttrs.bucket + \"/\" + path;\n\n\t\t\t\t\tformData.append('key', path);\n\t\t\t\t\tformData.append('AWSAccessKeyId', $window.videoAttrs.AWSAccessKeyId);\n\t\t\t\t\tformData.append('acl', $window.videoAttrs.acl);\n\t\t\t\t\tformData.append('success_action_status', $window.videoAttrs.success_action_status);\n\t\t\t\t\tformData.append('policy', $window.videoAttrs.policy);\n\t\t\t\t\tformData.append('signature', $window.videoAttrs.signature);\n\t\t\t\t\tformData.append('file', file);\n\n\t\t\t\t\tsetProgress(0);\n\t\t\t\t\tsetProgressText(\"Uploading...\");\n\t\t\t\t\tprogressBar.removeClass('progress-bar-success');\n\t\t\t\t\t// Todo: handle failure\n\n\t\t\t\t\tjQuery.ajax(url, {\n\t\t\t\t\t\tprocessData: false,\n\t\t\t\t\t\tcontentType: false,\n\t\t\t\t\t\tdata: formData,\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\txhr: function() {\n\t\t\t\t\t\t\tvar req = $.ajaxSettings.xhr();\n\t\t\t\t\t\t\tif (req) {\n\t\t\t\t\t\t\t\treq.upload.addEventListener('progress', function(e) {\n\t\t\t\t\t\t\t\tvar percent = (e.loaded / e.total ) * 100;\n\t\t\t\t\t\t\t\tsetProgress(percent);\n\t\t\t\t\t\t\t\t}, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$scope.req = req;\n\t\t\t\t\t\t\treturn req;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(data) {\n\t\t\t\t\t\t\tsetProgress(100);\n\t\t\t\t\t\t\tfakeInput.val(file.name);\n\t\t\t\t\t\t\t$http({\n\t\t\t\t\t\t\t\turl: '/videos/' + $scope.videoad.video.id ,\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\tdata: $.param({\n\t\t\t\t\t\t\t\t\t'filename': file.name\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\theaders: {'Content-Type': 'application/x-www-form-urlencoded'}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$http({\n\t\t\t\t\t\t\t\turl: '/videoads/' + $scope.videoad.id + \"/save\",\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\tdata: $.param({\n\t\t\t\t\t\t\t\t\t'videoId': $scope.videoad.video.id\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\theaders: {'Content-Type': 'application/x-www-form-urlencoded'}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tencode();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction encode(){\n\t\t\t\t\t$scope.encoding = true;\n\t\t\t\t\tprogressBar.addClass('progress-bar-success');\n\t\t\t\t\tsetProgressText(\"Encoding...\");\n\t\t\t\t\tsetProgress(5);\n\t\t\t\t\t// Kick off the zencoder job\n\t\t\t\t\t$http({\n\t\t\t\t\t\turl: '/videos/' + $scope.videoad.video.id + \"/encode\",\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t'name': $scope.videoad.video.name,\n\t\t\t\t\t\t}\n\t\t\t\t\t}).success(function(data){\n\t\t\t\t\t\t$scope.videoad.video.job_id = data.id;\n\t\t\t\t\t\tupdateEncodeProgress();\n\t\t\t\t\t}).error(function(){\n\t\t\t\t\t\t$scope.errors = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t$scope.chooseFile = function(){\n\t\t\t\t\tconsole.log(\"chooseFile\");\n\t\t\t\t\t$(fileInput).click();\n\t\t\t\t}\n\n\t\t\t\t$scope.clearFile = function(){\n\t\t\t\t\t$scope.videoad.video = {}\n\t\t\t\t}\n\n\t\t\t\tfunction abortUpload(){\n\t\t\t\t\tsetProgress(0);\n\t\t\t\t\t$scope.req && $scope.req.abort();\n\t\t\t\t\t$scope.videoad.video = {}\n\t\t\t\t\tsetProgress(0);\n\t\t\t\t}\n\n\t\t\t\tfunction abortEncode(){\n\t\t\t\t\t$.ajax(\"https://app.zencoder.com/api/v2/jobs/\" + $scope.videoad.video.job_id + \"/cancel.json?api_key=\" + $window.videoAttrs.zencoderApiKey, {\n\t\t\t\t\t\ttype: \"PUT\",\n\t\t\t\t\t\tsuccess: function(data) {\n\t\t\t\t\t\t\t$scope.videoad.video.status = 3;\n\t\t\t\t\t\t\tfakeInput.val(\"Encoding failed! Please try again.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t$scope.abort = function(){\n\t\t\t\t\tif($scope.encoding){\n\t\t\t\t\t\tabortEncode();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tabortUpload();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction setProgress(progress){\n\t\t\t\t\tif (progress === 0 || progress === 100) {\n\t\t\t\t\t\tprogressEl.hide();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif($scope.lastProgress === 0 || Math.abs(progress - $scope.lastProgress) > 2) {\n\t\t\t\t\t\tprogressBar.css('width', Math.floor(progress) + '%');\n\t\t\t\t\t\t$scope.lastProgress = progress;\n\t\t\t\t\t\tprogressEl.show();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction setProgressText(text){\n\t\t\t\t\tprogressText.html(text);\n\t\t\t\t}\n\n\t\t\t\tfunction updateEncodeProgress(){\n\t\t\t\t\tprogressBar.addClass('progress-bar-success');\n\n\t\t\t\t\tdelete $http.defaults.headers.common['X-Requested-With'];\n\t\t\t\t\t$http({\n\t\t\t\t\t\turl: \"https://app.zencoder.com/api/v2/jobs/\" + $scope.videoad.video.job_id + \"/progress.json\",\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tapi_key: $window.videoAttrs.zencoderApiKey\n\t\t\t\t\t\t},\n\t\t\t\t\t\tuseXDomain: true\n\t\t\t\t\t}).success(function(data){\n\t\t\t\t\t\tif(data.state === \"waiting\" || data.state === \"pending\" || data.state === \"processing\") {\n\t\t\t\t\t\t\t$scope.videoad.video.status = 2;\n\t\t\t\t\t\t\tif(data.progress > 5) {\n\t\t\t\t\t\t\t\tsetProgress(data.progress);\n\t\t\t\t\t\t\t\t$timeout(updateEncodeProgress, 500);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$timeout(updateEncodeProgress, 2000);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetProgress(0);\n\t\t\t\t\t\t\tif(data.state == \"finished\") {\n\t\t\t\t\t\t\t\t$scope.videoad.video.status = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(data.state == \"failed\" || data.state == \"cancelled\") {\n\t\t\t\t\t\t\t\t$scope.videoad.video.status = 3;\n\t\t\t\t\t\t\t\tfakeInput.val(\"Encoding failed! Please try again.\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}).error(function(data){\n\t\t\t\t\t\t$scope.errors = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar initialCheckRan = false;\n\t\t\t\t$scope.$watch('videoad.video', function(){\n\t\t\t\t\tif($scope.videoad.video && $scope.videoad.video.job_id && !initialCheckRan){\n\t\t\t\t\t\tupdateEncodeProgress();\n\t\t\t\t\t\tinitialCheckRan = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\n\t\t\t}\n\t\t}\n\t});","'use strict';\n\nangular.module('video-ads')\n  .directive('deliveryChart', function() {\n    return {\n      restrict: 'E',\n      templateUrl: STATIC_URL + 'partials/chart.html',\n      scope: {\n        impressions: '@impressions'\n      },\n      //Setting up Highcharts options\n      controller: function($scope) {\n        $scope.semiCircleConfig = {\n          options: {\n            chart: {\n              type: 'pie',\n              backgroundColor: 'transparent',\n              height: 75,\n              margin: 0,\n              width: 75,\n            },\n            credits: { enabled: false },\n            tooltip: { enabled: false },\n            colors: ['#008d52', '#e2e2e2'],\n          },\n          series: [{\n            dataLabels: { enabled: false },\n            states: {\n              hover: {\n                 enabled: false\n              }\n            },\n            animation: false,\n            startAngle: -90,\n            endAngle: 90,\n            center: ['50%', '75%'],\n            innerSize: '50%',\n            name: 'Delivery',\n            data: [\n              parseInt($scope.impressions), \n              (100 - parseInt($scope.impressions))\n            ]\n          }],\n          title: {\n            text: ''\n          },\n          subtitle: {\n            text: ''\n          },\n          loading: false\n        };\n      }\n    }\n  });","\"use strict\";\n//Service to get / create / delete video ads.\nangular.module(\"video-ads\")\n\t.factory('videoAdService', \n        function (Restangular) {\n    \t\tRestangular.setBaseUrl(\"/api/v1/\");\n    \t\tRestangular.setRequestSuffix(\"/\");\n\n            return Restangular.service(\"videoads\");\n\t})\n    .config(function (RestangularProvider) {\n        // Restangular likes lists to be returned as lists. DRF returns lists as a JSON object, with the list of objects inside of the response.results object.\n        // So, we write this response interceptor in order to return data.results in teh case the current operation is getList\n        RestangularProvider.addResponseInterceptor(function(data, operation) {\n            if (operation === \"getList\") {\n                var results = data.results;\n                results.meta = {\n                    count: data.count,\n                    prev: data.prev,\n                    next: data.next\n                };\n\n                return results;\n            }\n            return data;\n        });\n    });","angular.module('video-ads')\n    .factory('authInterceptor', function($rootScope, $q, $window, $location, httpRequestBuffer) {\n        return {\n            'request': function(config) {\n                config.headers = config.headers || {};\n                if ($window.sessionStorage.token) {\n                    config.headers.Authorization = \"JWT \" + $window.sessionStorage.token;\n                }\n                return config;\n            },\n            'responseError': function(response) {\n                if (!response.config.ignoreAuthModule) {\n                    if (response.status == 403) {\n                        var deferred = $q.defer();\n                        httpRequestBuffer.append(response.config, deferred)\n                        $rootScope.$broadcast('auth-forbidden', response);\n                    }\n                }\n                return $q.reject(response);\n            }\n        }\n    })\n    .config(function($httpProvider) {\n        $httpProvider.interceptors.push('authInterceptor');\n    })\n    .service(\"authService\", function($window, $http, $rootScope, $location, httpRequestBuffer) {\n        _login = function(username, password) {\n            return $http.post(\"/api-token-auth\")\n                .then(function(response) {\n                    $window.sessionStorage.token = response.data.token;\n                });\n        }\n        _refreshToken = function() {\n            return $http.post(\"/api-token-refresh\", {\n                    \"token\": $window.sessionStorage.token\n                }, {\n                    \"ignoreAuthModule\": true\n                }).success(function(response) {\n                    $window.sessionStorage.token = response.token;\n                    httpRequestBuffer.retryAll()\n                })\n                .error(function() {\n                    httpRequestBuffer.rejectAll();\n                    $location.path(\"/login\");\n                });\n        }\n\n        $rootScope.$watch(\"auth-forbidden\", function() {\n            _refreshToken();\n        });\n        return {\n            login: _login,\n            refreshToken: _refreshToken\n        }\n    })\n// Thanks to witoldsz/angular-http-auth\n.factory('httpRequestBuffer', ['$injector',\n    function($injector) {\n        var buffer = [];\n\n        var $http;\n\n        function _retryHttpRequest(config, deferred) {\n            function successCallback(response) {\n                deferred.resolve(response);\n            }\n\n            function errorCallback(response) {\n                deferred.reject(response);\n            }\n            $http = $http || $injector.get(\"$http\");\n            $http(config).then(successCallback, errorCallback);\n        }\n\n        return {\n            append: function(config, deferred) {\n                buffer.push({\n                    config: config,\n                    deferred: deferred\n                });\n            },\n            rejectAll: function(reason) {\n                if (reason) {\n                    _.each(buffer, function(request) {\n                        request.deferred.reject(reason);\n                    });\n                }\n                buffer = [];\n            },\n            retryAll: function() {\n                _.each(buffer, function(request) {\n                    _retryHttpRequest(request.config, request.deferred);\n                });\n            }\n        }\n\n    }\n]);","'use strict';\n\nangular.module('video-ads')\n\t.filter('convertToLocal', function() {\n    return function (input) {\n      if (input) {\n        return moment.utc(input).local().format('YYYY-MM-DD hh:mm A');\n      }\n      return input;\n    };\n  });"]}